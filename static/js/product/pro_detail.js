$(function(){var o=new Swiper(".swiper-container",{pagination:{el:".swiper-pagination",clickable:!0},lazy:{loadPrevNext:!0},autoplay:{delay:4e3},direction:"horizontal",loop:!0});$(".icon-share").on("click",function(){console.log("分享")}),$(".dt-wish").on("click",function(){console.log("收藏")});var t=$(".dt-cp-bg"),a=$(".dt-cp-list");$(".dt-coupon").on("click",function(){t.animate({opacity:.6},350).removeClass("d-n"),a.animate({bottom:0},400,"ease-out")}),t.on("click",function(){t.animate({opacity:0},350),a.animate({bottom:"-150%"}),setTimeout(function(){t.addClass("d-n")},350)}),$(".icon-close").on("click",function(){a.animate({bottom:"-150%"}),t.animate({opacity:0},350),setTimeout(function(){t.addClass("d-n")},350)}),$(".can-receive").on("click",function(){console.log("优惠券ID："+$(this).attr("data-id"))});var e=1;i=e/i;var i=null;attrs.forEach(function(t,a){e*=t.attrValues.length,t.mainAttrFlag&&(i=t.attrValues.length)});JSON.stringify(skus);function c(){attrs.forEach(function(t,a){t.attrValues.forEach(function(n,t){n.newSkus=[],n.newSkus2=[],skus.forEach(function(e,i){e.attrs.forEach(function(t,a){n.valueId===t.valueId&&0<e.quantity&&(n.newSkus.push(t),n.newSkus2.push(e)),i===skus.length-1&&a===e.attrs.length-1&&n.newSkus.length<1?$("#id"+n.valueId).addClass("dt-disable"):$("#id"+n.valueId).removeClass("dt-disable")})})})})}c(),$(".dt-attr-child").on("click",function(){var t=$(this),e=t.attr("data-index"),i=(t.attr("attr-key"),t.attr("attr-id"),null),n=null;if(e){attrs.forEach(function(t,a){t.mainAttrFlag&&(i=t.attrValues[e].skuPictures[0].smallImg,n=t.attrValues[e].value)}),document.getElementsByClassName("add-silde-img")[0]?($(".add-silde-img").attr("src",i),$(".add-silde-img").parent("a").attr("href",i)):(o.appendSlide('<div class="swiper-slide"><a href="'+i+'"><img class="add-silde-img" src="'+i+'" alt="'+n+'"></a></div>'),o.pagination.render());var a=$(".swiper-pagination-bullet");$(".swiper-pagination-bullet").eq(a.length-1).trigger("click")}if(!t.hasClass("dt-disable")){t.siblings().each(function(t,a){$(a).removeClass("attr-select")}),t.toggleClass("attr-select");var s=[];$(".attr-select").each(function(t,a){s.push(a.getAttribute("attr-id"))}),function(e){console.log(e);var o=[],l="0";if(attrs.forEach(function(t,i){t.attrValues.forEach(function(a,t){e.forEach(function(e,t){e==a.valueId&&a.newSkus2.forEach(function(t,a){t.attrs.forEach(function(t,a){$("#id"+t.valueId).removeClass("dt-disable"),t.valueId!=e&&(o.push(t.valueId),l=i)})})})})}),e.length<1)return c();o=o.toString(),$(".dt-attr-child").not(".dt-disable").each(function(t,a){var e=a.getAttribute("attr-id"),i=a.getAttribute("attr-key"),n=new RegExp(e,"ig"),s=new RegExp(i,"ig");n.test(o)||s.test(l)||a.classList.add("dt-disable")})}(s)}});$(".icon-comp").on("click",function(){var t=$(this),a=t.attr("id"),e=$(".dt-quantity").val();if(1<e<5&&($("#sub").removeClass("dt-min-sub"),$("#add").removeClass("dt-min-sub")),"add"===a){if(5<=e)return void t.addClass("dt-min-sub");e&&0<e&&(e++,$(".dt-quantity").val(e))}else if("sub"===a){if((e=--e)<1)return $(".dt-quantity").val(1),void $("#sub").addClass("dt-min-sub");$(".dt-quantity").val(e)}}),$(".dt-quantity").on("blur",function(){var t=this.value.trim();(t<0||!t||!/^[0-9]+$/g.test(t)||5<t)&&(this.value=1)}),$(".dt-spec-title").on("click",function(t){var a=$("#"+t.target.getAttribute("data-attr")).offset().top;$(window).scrollTo({toT:a-80},500),$(".dt-spec-active").removeClass("dt-spec-active"),$(this).addClass("dt-spec-active")});var n=$(".dt-spec-nav").offset().top;$(window).scroll(function(){var t=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;n<=t?$(".dt-spec-nav").addClass("dt-spec-fixed"):$(".dt-spec-nav").removeClass("dt-spec-fixed")})});